<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Kai Wu | Interpretation of transformations and the relation with the coordinate system</title>
  <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

  <link rel="shortcut icon" href="https://imkaywu.github.io/assets/img/favicon.ico">
  <link rel="stylesheet" href="https://imkaywu.github.io/assets/css/main.css">
  <link rel="canonical" href="https://imkaywu.github.io/blog/2017/02/transformation/">
</head>

  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML'></script>

  <body>

    <header class="site-header">

  <div class="wrapper">

    
    <span class="site-title">
        
        <strong>Kai</strong> Wu
    </span>
    

    <nav class="site-nav">

      <div class="trigger">
        <!-- About -->
        <a class="page-link" href="https://imkaywu.github.io/">about</a>

        <!-- Blog -->
        <a class="page-link" href="https://imkaywu.github.io/blog/">blog</a>

        <!-- Pages -->
        
          
        
          
            <a class="page-link" href="https://imkaywu.github.io/code/">code</a>
          
        
          
        
          
            <a class="page-link" href="https://imkaywu.github.io/links/">links</a>
          
        
          
        
          
            <a class="page-link" href="https://imkaywu.github.io/projects/">projects</a>
          
        
          
            <a class="page-link" href="https://imkaywu.github.io/tutorials/">tutorials</a>
          
        
          
        
          
        
          
        

        <!-- CV link -->
        <!-- <a class="page-link" href="https://imkaywu.github.io/assets/pdf/CV.pdf">vitae</a> -->

      </div>
    </nav>

  </div>

</header>



    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Interpretation of transformations and the relation with the coordinate system</h1>
    <p class="post-meta">February 3, 2017</p>
  </header>

  <article class="post-content">
    <p>This is a post of useful notes and tricks on transformation for future reference.</p>

<h2 id="geometric-interpretation-of-3d-rotation-matrix">Geometric Interpretation of 3D rotation matrix</h2>
<ul>
  <li>Rows(<del>Column</del>) of matrix are 3 unit vector of the new coordinate frame (?);</li>
  <li>Can construct rotation matrix from 3 orthonormal vectors;</li>
  <li>3D rotation can be interpretated projections of point into new coordinate frame;</li>
  <li>New coordinate frame <script type="math/tex">uvw</script> taken to cartesian components <script type="math/tex">xyz</script> (Let <script type="math/tex">\vec{p}</script> be <script type="math/tex">\vec{u}</script>, then <script type="math/tex">Rp=\vec{x}=\begin{bmatrix} 1\\ 0\\ 0\\ \end{bmatrix}</script>);</li>
  <li>Inverse or transpose takes <script type="math/tex">xyz</script> cartesian to <script type="math/tex">uvw</script>.</li>
</ul>

<h3 id="proof-of-the-first-point">Proof of the first point:</h3>
<div class="img_row">
    <img class="col three" src="/assets/img/open3DCV/rot_interp.pdf" alt="rotation interpretation" title="Rotation Interpretation" />
</div>

<p>The axes of the new coordinate system are
<script type="math/tex">u = \begin{bmatrix}
\cos\theta \\ -\sin\theta
\end{bmatrix}\\
v = \begin{bmatrix}
\sin\theta \\ \cos\theta
\end{bmatrix}\\</script></p>

<p>thus we have</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{bmatrix}
u \\ v
\end{bmatrix}=
\begin{bmatrix}
\cos\theta & -\sin\theta\\
\sin\theta & \cos\theta
\end{bmatrix}
\begin{bmatrix}
x \\ y
\end{bmatrix} %]]></script>

<p><strong>Another proof is</strong>: suppose we have two coordinate systems, <script type="math/tex">CS_1</script> and <script type="math/tex">CS_2</script>, having coincident origins (?), but having different orientations. Let <script type="math/tex">\vec{i}, \vec{j}, \vec{k}</script> be the basis vectors, or axes of <script type="math/tex">CS_1</script>, and <script type="math/tex">\vec{m}, \vec{n}, \vec{o}</script> be the basis vectors of <script type="math/tex">SC_2</script>. The coordinates of <script type="math/tex">P</script> in <script type="math/tex">SC_1</script> is <script type="math/tex">(x, y, z)</script>, and the coordinates in <script type="math/tex">SC_2</script> is <script type="math/tex">(a, b, c)</script>.</p>

<div class="img_row">
    <img class="col one" src="/assets/img/open3DCV/tbasis.gif" alt="rotation interpretation" title="Rotation Interpretation" />
</div>

<p>The transformation between the two coordinate systems can be obtain as follows</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}
P&=a\vec{m}+b\vec{n}+c\vec{o}\\
 &=a\begin{bmatrix} 1\\0\\0 \end{bmatrix} +
   b\begin{bmatrix} 0\\1\\0 \end{bmatrix} +
   c\begin{bmatrix} 0\\0\\1 \end{bmatrix} \quad (\text{in } CS_2)\\
 &=a\begin{bmatrix} m_x\\m_y\\m_z \end{bmatrix} +
   b\begin{bmatrix} n_x\\n_y\\n_z \end{bmatrix} +
   c\begin{bmatrix} o_x\\o_y\\o_z \end{bmatrix} \quad (\text{in } CS_1)\\
   \begin{bmatrix}
 	x \\ y \\ z \\ 1
   \end{bmatrix}
 &=\begin{bmatrix}
 	m_x & n_x & o_x & 0\\
 	m_y & n_y & o_y & 0\\
 	m_z & n_z & o_z & 0\\
 	0 & 0 & 0 & 1
   \end{bmatrix}
 	\begin{bmatrix}
 	a\\b\\c\\1
 	\end{bmatrix}
\end{align*} %]]></script>

<p>Thus the elements of the top-left 3x3 portion of any geometric transformation are really the basis vectors of the local coordinate system (<script type="math/tex">SC_2</script>?) expressed in the coordinates of the new coordinate system (<script type="math/tex">SC_1</script>?). This interpretation views transformation as a change of basis, which let us construct transformations between two coordinate systems directly, without having to express the transformations in terms of one or more rotation and translation operations.</p>

<p><strong>Yet another explanaition</strong>: <script type="math/tex">\vec{u}</script> is the <script type="math/tex">x-</script>axis of the camera frame in the world coordinate system, <script type="math/tex">\begin{bmatrix} 1\\0\\0 \end{bmatrix}</script> is the <script type="math/tex">x-</script>axis of camera frame in the camera coordinate system, <script type="math/tex">\begin{bmatrix} \vec{u}^\top \\ \vec{v}^\top \\ \vec{w}^\top \end{bmatrix}</script> is the rotation matrix from world coordinate system to camera coordinate system.</p>

<script type="math/tex; mode=display">\begin{align*}
\begin{bmatrix} 1\\0\\0 \end{bmatrix} = 
\begin{bmatrix} \vec{u}^\top \\ \vec{v}^\top \\ \vec{w}^\top \end{bmatrix}
\vec{u}
\end{align*}</script>

<h3 id="proof-of-the-third-point">Proof of the third point:</h3>
<p><script type="math/tex">% <![CDATA[
Rp = 
\begin{bmatrix}
x_u & y_u & z_u\\
x_v & y_v & z_v\\
x_w & y_w & z_w\\
\end{bmatrix} 
\begin{bmatrix}
x_p\\
y_p\\
z_p\\
\end{bmatrix} =
\begin{bmatrix}
\vec{u} \cdot \vec{p}\\
\vec{v} \cdot \vec{p}\\
\vec{w} \cdot \vec{p}\\
\end{bmatrix} %]]></script></p>

<hr />

<h2 id="compostion-of-transformations">Compostion of Transformations</h2>

<p>Transformations can be thought of as a change of object or a change in coordinate system.</p>

<p><strong>Rule of thumb</strong>: The transformations necessary to convert a point from CS2 to CS1 are given by the transformations necessary to align the CS1 frame with the CS2 frame.</p>

<!-- <div class="img_row">
	<img class="col three" src="/assets/img/research/transform/examp_trans.png">
</div>

$$
p''=T(2, 3, 0)R(z, -90)p
$$ -->

<h3 id="transform-the-coordinates">Transform the coordinates</h3>
<div class="img_row">
	<img class="col three" src="/assets/img/research/transform/transform.pdf" />
</div>

<ul>
  <li>right to left:
    <ul>
      <li>interpret operations w.r.t fixed global coordinates</li>
      <li>moving object
        <ul>
          <li>draw object</li>
          <li>rotate object by 45 degrees w.r.t. fixed global coordinates</li>
          <li>translate it (1, 1) over w.r.t fixed global coordinates</li>
        </ul>
      </li>
      <li>Premultiplication effects a transformation in ‘world’ or ‘fixed’ coordinates</li>
    </ul>
  </li>
</ul>

<h3 id="transform-the-coordinate-frame">Transform the coordinate frame</h3>
<div class="img_row">
	<img class="col three" src="/assets/img/research/transform/transform_1.pdf" />
</div>

<ul>
  <li>left to right:
    <ul>
      <li>interprete operations w.r.t. local coordinates</li>
      <li>changing coordinate system
        <ul>
          <li>translate coordinate system (1, 1) over</li>
          <li>rotate coordinate system 45 degrees w.r.t. local origin</li>
          <li>draw object in current coordinate system</li>
        </ul>
      </li>
      <li>Postmultiplication effects a transformation in ‘local’ coodinates.</li>
      <li>OpenGL postmultiplies transformation, i.e., applies them in ‘local’ coordinates.</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="transformation-of-normals">Transformation of normals</h2>
<p><script type="math/tex">\begin{align*}
\vec{n}^\top \vec{p} = \vec{n}^\top M^{-1}M\vec{p}=(M^{-\top}\vec{n})^\top \vec{p'}
\end{align*}</script></p>

<p>Thus the transformation matrix of a normal is <script type="math/tex">M^{-\top}</script>. This inverse transposition is applied to the upper <script type="math/tex">3\times 3</script> only, thus <script type="math/tex">M</script> is the upper <script type="math/tex">3\times 3</script> matrix.</p>

<hr />

<h2 id="derivation-of-axis-angle-formula">Derivation of Axis-Angle formula</h2>
<p>Rotate vector <script type="math/tex">\vec{b}</script> <script type="math/tex">\theta</script> about vector <script type="math/tex">\vec{a}</script>, both <script type="math/tex">\vec{a}</script> and <script type="math/tex">\vec{b}</script> are unit vectors.</p>

<ul>
  <li>Step 1: <script type="math/tex">\vec{b}</script> has component paralle to <script type="math/tex">\vec{a}</script>, which is unchanged, and component perpendicular to <script type="math/tex">\vec{a}</script>.</li>
</ul>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}
\vec{b_\parallel} &= (\vec{a}\cdot\vec{b})\vec{a}\\
\vec{b_\perp} &= \vec{b}-\vec{b_\parallel}
\end{align*} %]]></script>

<ul>
  <li>Step 2: Define <script type="math/tex">\vec{c}</script> orthogonal to both <script type="math/tex">\vec{a}</script> and <script type="math/tex">\vec{b}</script>:</li>
</ul>

<script type="math/tex; mode=display">\vec{c}=\vec{a}\times\vec{b}</script>

<ul>
  <li>Step 3: the perpendicular component is decomposed into two parts after rotating <script type="math/tex">\theta</script></li>
</ul>

<script type="math/tex; mode=display">\vec{c}\sin\theta\\
\vec{b_\perp}\cos\theta</script>

<p>Therefore, the final rotated vector are:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}
\text{parallel component: } & (\vec{a}\cdot\vec{b})\vec{a} \\ 
							=& (\vec{a}^\top\vec{b})\vec{a}\\
							=& (\vec{a}\vec{a}^\top)\vec{b} \quad (\vec{a}^\top\vec{b} \text{ is a scalar})\\
\text{perpendicular component 1: } & \vec{c}\sin\theta\\
								   =&\vec{a}\times\vec{b}\\
								   =&([\vec{a}]_\times\sin\theta)\vec{b}\\
\text{perpendicular component 2: } & \vec{b_\perp}\cos\theta\\
								   =&(\vec{b}-\vec{b_\parallel})\cos\theta\\
								   =&(\vec{b}-(\vec{a}\vec{a}^\top)\vec{b})\cos\theta\\
								   =&(I_{3\times 3}\cos\theta-\vec{a}\vec{a}^\top\cos\theta)\vec{b}
\end{align*} %]]></script>

<p>Putting all these together, the rotation matrix can be written as</p>

<script type="math/tex; mode=display">R(\vec{a}, \theta)=I_{3\times 3}\cos\theta+\vec{a}\vec{a}^\top(1-\cos\theta)+[\vec{a}]_\times\sin\theta</script>

<p>This is generally refered to as the <code class="highlighter-rouge">Rodrigues formular</code>.</p>

  </article>

  

</div>

      </div>
    </div>

    <footer>

  <div class="wrapper">
    &copy; Copyright 2017 Kai Wu.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
  </div>

</footer>


    <!-- Load jQuery -->
<script src="//code.jquery.com/jquery-1.12.4.min.js"></script>

<!-- Load Common JS -->
<script src="https://imkaywu.github.io/assets/js/common.js"></script>





<!-- Include custom icon fonts -->
<link rel="stylesheet" href="https://imkaywu.github.io/assets/css/font-awesome.min.css">
<link rel="stylesheet" href="https://imkaywu.github.io/assets/css/academicons.min.css">

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-XXXXXXXX-X', 'auto');
ga('send', 'pageview');
</script>


  </body>

</html>
